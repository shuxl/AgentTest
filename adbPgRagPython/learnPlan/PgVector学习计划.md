# PgVector 系统学习计划

## 📋 学习目标

通过系统的学习和实践，掌握 PgVector 的核心概念、安装配置、基本操作、高级特性以及在实际项目中的应用。

## 🎯 整体学习路径

本学习计划分为6个阶段，从基础概念到实际应用，循序渐进：

1. **环境准备与基础认知** - 理解向量数据库概念，确认Docker环境
2. **PgVector 安装与配置** - 安装扩展，创建向量数据库
3. **基础操作实践** - 向量存储、查询、相似度搜索
4. **索引优化学习** - HNSW、IVFFlat 索引创建与优化
5. **Python 应用开发** - 使用 Python 客户端进行实际开发
6. **综合项目实践** - 构建一个完整的向量检索应用

---

## 📚 第一阶段：环境准备与基础认知

### 学习目标
- 理解向量数据库的基本概念
- 了解 PgVector 的核心特性和应用场景
- 确认 Docker 环境已正确搭建

### 学习内容
1. **向量数据库基础理论**
   - 什么是向量数据库
   - 向量嵌入（Embedding）的概念
   - 相似度度量方法（余弦相似度、欧氏距离、内积）
   - 向量检索的应用场景（相似文本搜索、推荐系统、图像检索等）

2. **PgVector 简介**
   - PgVector 是什么：PostgreSQL 的向量扩展
   - 核心优势：SQL原生支持、事务一致性、丰富的索引类型
   - 与其他向量数据库的对比（Milvus、Pinecone、Weaviate）

3. **Docker 环境确认**
   - 检查 Docker 容器运行状态
   - 确认 PostgreSQL 版本（建议 11+）
   - 测试数据库连接

### 实践任务
- [ ] 启动 Docker 中的 PostgreSQL 容器
- [ ] 使用 psql 或客户端工具连接到数据库
- [ ] 查看 PostgreSQL 版本信息
- [ ] 阅读 PgVector 官方文档：https://github.com/pgvector/pgvector

### 预计时间
2-3 小时

---

## 🔧 第二阶段：PgVector 安装与配置

### 学习目标
- 掌握 PgVector 扩展的安装方法
- 学会创建启用向量的数据库
- 理解向量的数据类型

### 学习内容
1. **安装 pgvector 扩展**
   - 在 Docker 容器中安装扩展
   - 使用 CREATE EXTENSION 命令启用
   - 验证扩展安装成功

2. **向量数据类型**
   - `vector` 类型：可变维度向量
   - 向量维度限制（默认 16,000 维）
   - 创建包含向量列的表

3. **基础表结构设计**
   - 理解如何设计存储向量的表结构
   - 元数据字段的设计
   - 主键和外键的考虑

### 实践任务
- [ ] 在数据库中安装 pgvector 扩展
- [ ] 创建一个测试表，包含 vector 类型列
- [ ] 插入几条包含向量的测试数据
- [ ] 查看表结构和数据

### 代码示例位置
将在本阶段创建 `01_install_and_setup/` 目录，包含：
- 安装脚本
- 表创建脚本
- 基础测试数据插入脚本

### 预计时间
2-3 小时

---

## 🚀 第三阶段：基础操作实践

### 学习目标
- 掌握向量的插入、更新、删除操作
- 学会使用相似度搜索函数
- 理解不同相似度度量的使用场景

### 学习内容
1. **向量数据操作**
   - INSERT：插入向量数据
   - UPDATE：更新向量值
   - DELETE：删除向量记录

2. **相似度搜索函数**
   - `<=>`：余弦距离运算符
   - `<->`：欧氏距离运算符
   - `<#>`：负内积运算符
   - 理解距离 vs 相似度

3. **基础查询模式**
   - 找到最相似的 N 个向量（ORDER BY + LIMIT）
   - 设置相似度阈值过滤
   - 结合 WHERE 条件进行过滤搜索

4. **向量维度理解**
   - 不同嵌入模型的维度（如 OpenAI text-embedding-v3: 1024维）
   - 如何选择合适的维度
   - 维度对性能的影响

### 实践任务
- [ ] 创建一个包含 128 维向量的测试表
- [ ] 插入至少 100 条带向量的记录
- [ ] 执行余弦相似度搜索，找到最相似的 10 条记录
- [ ] 执行欧氏距离搜索
- [ ] 实现带阈值的相似度搜索
- [ ] 结合文本元数据进行混合搜索

### 代码示例位置
将在本阶段创建 `02_basic_operations/` 目录，包含：
- 数据插入脚本
- 各种相似度搜索示例
- 查询性能对比脚本

### 预计时间
4-5 小时

---

## ⚡ 第四阶段：索引优化学习

### 学习目标
- 理解向量索引的重要性
- 掌握 HNSW 和 IVFFlat 索引的使用
- 学会根据场景选择合适的索引策略

### 学习内容
1. **为什么需要索引**
   - 全表扫描的性能问题
   - 索引对查询速度的提升
   - 索引的内存开销

2. **HNSW 索引**
   - Hierarchical Navigable Small World 算法原理
   - 创建语法和参数（m, ef_construction）
   - 适用场景：高维向量、频繁查询
   - 优缺点分析

3. **IVFFlat 索引**
   - Inverted File with Flat Compression 算法原理
   - 创建语法和参数（lists）
   - 适用场景：大规模数据、批量查询
   - 优缺点分析

4. **索引维护**
   - 索引重建
   - 索引参数调优
   - 索引对插入性能的影响

### 实践任务
- [ ] 创建 HNSW 索引并测试查询性能
- [ ] 创建 IVFFlat 索引并测试查询性能
- [ ] 对比有无索引的查询速度差异
- [ ] 测试不同索引参数对性能的影响
- [ ] 对 10,000+ 条向量数据建立索引并测试

### 代码示例位置
将在本阶段创建 `03_index_optimization/` 目录，包含：
- 索引创建脚本
- 性能测试脚本
- 索引参数对比测试

### 预计时间
4-6 小时

---

## 🐍 第五阶段：Python 应用开发

### 学习目标
- 掌握使用 Python 连接 PgVector 数据库
- 学会使用 psycopg2 或 SQLAlchemy 操作向量数据
- 实现完整的 Python 向量检索应用

### 学习内容
1. **Python 客户端选择**
   - psycopg2：官方推荐的 PostgreSQL 驱动
   - SQLAlchemy：ORM 框架，支持向量类型
   - 其他可选库（asyncpg 等）

2. **连接数据库**
   - 连接字符串配置
   - 连接池管理
   - 错误处理机制

3. **向量操作封装**
   - 向量插入函数封装
   - 相似度搜索函数封装
   - 批量操作优化

4. **实际应用场景**
   - 文本向量化（使用 embedding 模型）
   - 相似文档检索
   - 结合其他查询条件的混合搜索

### 实践任务
- [ ] 创建 Python 项目结构
- [ ] 实现数据库连接工具类
- [ ] 实现向量插入和查询的封装函数
- [ ] 使用真实的文本 embedding 模型（如 sentence-transformers）进行测试
- [ ] 实现一个简单的文档检索系统（输入查询文本，返回相似文档）

### 代码示例位置
将在本阶段创建 `04_python_integration/` 目录，包含：
- Python 项目结构
- 数据库工具类
- 向量操作封装
- 示例应用代码

### 预计时间
6-8 小时

---

## 🎓 第六阶段：综合项目实践

### 学习目标
- 整合前面所学知识
- 构建一个完整的向量检索应用
- 掌握性能优化和最佳实践

### 学习内容
1. **项目设计**
   - 需求分析
   - 数据库架构设计
   - API 接口设计

2. **完整功能实现**
   - 文档上传和向量化
   - 向量存储和管理
   - 相似度搜索接口
   - 结果排序和过滤

3. **性能优化**
   - 批量插入优化
   - 查询性能调优
   - 索引策略优化
   - 缓存机制（可选）

4. **最佳实践总结**
   - 数据建模最佳实践
   - 索引选择指南
   - 查询优化技巧
   - 常见问题排查

### 实践任务
- [ ] 设计一个文档问答系统（RAG 基础）
   - 文档分块和向量化
   - 向量存储到 PgVector
   - 问题向量化后检索相关文档
   - 返回 Top-K 相似结果
- [ ] 实现 API 接口（使用 FastAPI 或 Flask）
- [ ] 添加查询性能监控
- [ ] 编写使用文档

### 代码示例位置
将在本阶段创建 `05_project_practice/` 目录，包含：
- 完整的项目代码
- API 接口实现
- 使用文档
- 性能测试报告

### 预计时间
8-10 小时

---

## 📊 学习进度跟踪

使用以下检查清单跟踪学习进度：

- [ ] 第一阶段：环境准备与基础认知
- [ ] 第二阶段：PgVector 安装与配置
- [ ] 第三阶段：基础操作实践
- [ ] 第四阶段：索引优化学习
- [ ] 第五阶段：Python 应用开发
- [ ] 第六阶段：综合项目实践

---

## 📖 推荐学习资源

1. **官方文档**
   - PgVector GitHub: https://github.com/pgvector/pgvector
   - PgVector 文档: https://github.com/pgvector/pgvector#readme

2. **参考书籍和文章**
   - PostgreSQL 官方文档（向量扩展部分）
   - 向量数据库技术相关博客文章

3. **实践数据集**
   - 可以使用公开的文本数据集进行实践
   - 推荐：Wikipedia 片段、新闻文章、问答对等

---

## ⏱️ 总体时间规划

- **第一阶段**：2-3 小时
- **第二阶段**：2-3 小时
- **第三阶段**：4-5 小时
- **第四阶段**：4-6 小时
- **第五阶段**：6-8 小时
- **第六阶段**：8-10 小时

**总计**：约 26-35 小时（根据个人基础和学习速度调整）

---

## 💡 学习建议

1. **循序渐进**：每个阶段都包含理论学习和实践操作，不要跳过基础阶段
2. **动手实践**：理论知识必须通过实际操作来巩固
3. **记录笔记**：记录遇到的问题和解决方案
4. **性能测试**：注意观察不同配置对性能的影响
5. **项目驱动**：最后阶段的项目实践可以结合你的实际需求

---

## 🎯 学习成果

完成本学习计划后，你将能够：

✅ 独立安装和配置 PgVector  
✅ 理解向量数据库的核心概念和应用场景  
✅ 熟练使用 SQL 进行向量操作和相似度搜索  
✅ 根据场景选择合适的索引策略  
✅ 使用 Python 开发基于 PgVector 的应用  
✅ 构建完整的向量检索系统  
✅ 进行性能优化和问题排查  

---

**祝你学习顺利！开始第一阶段的学习吧！** 🚀

